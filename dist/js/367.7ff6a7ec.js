"use strict";(self["webpackChunktrekkingcastillayleon"]=self["webpackChunktrekkingcastillayleon"]||[]).push([[367],{4578:function(a,e,t){t.r(e),t.d(e,{default:function(){return E}});var o=t(6252),i=t(3577);const n=a=>((0,o.dD)("data-v-14a4ec63"),a=a(),(0,o.Cn)(),a),r=(0,o.Uk)("Explora"),c=(0,o.Uk)("Explora"),l=(0,o.Uk)("Ruta"),s=(0,o.Uk)("Cerrar"),d=n((()=>(0,o._)("p",null,"Selecciona la opción que quieres modificar:",-1))),u=["src"],m=(0,o.Uk)("Comentarios"),f=(0,o.Uk)("Cerrar"),p=(0,o.Uk)("Añade tu comentario");function b(a,e,t,n,b,h){const w=(0,o.up)("ion-title"),g=(0,o.up)("ion-toolbar"),R=(0,o.up)("ion-header"),I=(0,o.up)("IconoSVGBlanco"),k=(0,o.up)("ion-col"),_=(0,o.up)("ion-row"),v=(0,o.up)("ion-grid"),W=(0,o.up)("ion-content"),C=(0,o.up)("ion-icon"),U=(0,o.up)("ion-button"),y=(0,o.up)("ion-searchbar"),x=(0,o.up)("ion-item"),M=(0,o.up)("ion-label"),D=(0,o.up)("ion-card-header"),S=(0,o.up)("ion-img"),P=(0,o.up)("swiper-slide"),O=(0,o.up)("swiper"),V=(0,o.up)("ion-buttons"),z=(0,o.up)("ion-list"),F=(0,o.up)("ion-modal"),j=(0,o.up)("ion-avatar"),Z=(0,o.up)("ion-text"),N=(0,o.up)("ion-card-content"),B=(0,o.up)("ion-footer"),E=(0,o.up)("ion-card"),A=(0,o.up)("ion-input"),L=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(L,null,{default:(0,o.w5)((()=>[(0,o.Wm)(R,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[r])),_:1})])),_:1})])),_:1}),a.cargando?((0,o.wg)(),(0,o.j4)(W,{key:0,fullscreen:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"grid"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"row"},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{class:"col"},{default:(0,o.w5)((()=>[(0,o.Wm)(I)])),_:1})])),_:1})])),_:1})])),_:1})):((0,o.wg)(),(0,o.j4)(W,{key:1,fullscreen:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(R,{collapse:"condense"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,{onClick:e[0]||(e[0]=e=>a.goAddRoute()),color:"medium"},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.addCircleOutline},null,8,["icon"])])),_:1}),(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,{size:"large"},{default:(0,o.w5)((()=>[c])),_:1})])),_:1}),(0,o.Wm)(y,{animated:""})])),_:1})])),_:1}),(0,o.Wm)(z,{class:"listaRutas"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.rutas,(t=>((0,o.wg)(),(0,o.j4)(x,{key:t.id},{default:(0,o.w5)((()=>[(0,o.Wm)(E,{class:"ruta"},{default:(0,o.w5)((()=>[(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(M,null,{default:(0,o.w5)((()=>[(0,o._)("h4",null,(0,i.zw)(t.nombreRuta),1),(0,o._)("h3",null,[(0,o.Wm)(C,{icon:a.locationOutline},null,8,["icon"]),(0,o.Uk)(" "+(0,i.zw)(t.localizacion)+" "+(0,i.zw)(t.kilometros)+" Kms ",1)])])),_:2},1024),t.usuario!==a.nombreUsuario?((0,o.wg)(),(0,o.j4)(U,{key:0,color:"danger",onClick:e[1]||(e[1]=e=>a.denunciarRuta())},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.alertOutline},null,8,["icon"])])),_:1})):((0,o.wg)(),(0,o.j4)(U,{key:1,color:"danger",onClick:e=>a.borrarRuta(t.nombreRuta,t.tipoRuta)},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.closeOutline},null,8,["icon"])])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1024),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{modules:a.modules,pager:"true",options:a.slideOpts,navigation:"",pagination:{clickable:!0}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.imagenesIntroducidas,((a,e)=>((0,o.wg)(),(0,o.j4)(P,{key:e},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{src:a},null,8,["src"])])),_:2},1024)))),128))])),_:2},1032,["modules","options"])])),_:2},1024),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[t.usuario!==a.nombreUsuario?((0,o.wg)(),(0,o.j4)(k,{key:0,class:"columnaComentarios"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:"botonComentarios",color:"success",onClick:e=>a.rutaRealizada(t.imagenesIntroducidas,t.tipoRuta)},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.checkmarkDoneSharp},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)):((0,o.wg)(),(0,o.j4)(k,{key:1,class:"columnaComentarios"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:"botonComentarios",color:"warning",onClick:e=>a.modificarRuta(t)},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.pencilSharp},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)),(0,o.Wm)(k,{class:"columnaComentarios"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:"botonComentarios",color:"medium",onClick:e=>a.setOpen(!0,t.nombreRuta)},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{icon:a.chatbubbles},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,o.Wm)(F,{"is-open":a.modificandoRuta},{default:(0,o.w5)((()=>[(0,o.Wm)(R,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[l])),_:1}),(0,o.Wm)(V,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{onClick:e[2]||(e[2]=e=>a.setOpenModalModificar())},{default:(0,o.w5)((()=>[s])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(W,{class:"ion-padding"},{default:(0,o.w5)((()=>[d,(0,o.Wm)(z,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.opciones,(e=>((0,o.wg)(),(0,o.j4)(x,{key:e.nombre},{default:(0,o.w5)((()=>[(0,o.Wm)(M,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e),1)])),_:2},1024),(0,o.Wm)(C,{slot:"end",icon:a.chevronForwardOutline,onClick:t=>a.modificarCampos(e)},null,8,["icon","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},8,["is-open"]),(0,o.Wm)(N,{class:"cardContent"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{onClick:e=>a.irPerfilUsuario(t.emailRuta)},{default:(0,o.w5)((()=>[(0,o.Wm)(j,{slot:"end"},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.fotoPerfilUsuarioIntroducida},null,8,u)])),_:2},1024),(0,o.Wm)(Z,{color:"dark"},{default:(0,o.w5)((()=>[(0,o._)("h3",null,(0,i.zw)(t.usuario),1),(0,o._)("h2",null,(0,i.zw)(t.nivelUsuario),1)])),_:2},1024),(0,o.Wm)(Z,{color:"medium"})])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(B,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(k,{center:"","text-center":""},{default:(0,o.w5)((()=>[(0,o._)("button",null,[(0,o._)("div",null,[(0,o.Wm)(C,{icon:t.iconoIntroducido},null,8,["icon"]),(0,o.Uk)(" "+(0,i.zw)(t.tipoRuta),1)])])])),_:2},1024),(0,o.Wm)(k,{center:"","text-center":""},{default:(0,o.w5)((()=>[(0,o._)("button",null,[(0,o._)("div",null,[(0,o.Uk)((0,i.zw)(t.valoracion)+" ",1),(0,o.Wm)(C,{icon:a.starOutline},null,8,["icon"])])])])),_:2},1024),(0,o.Wm)(k,{center:"","text-center":""},{default:(0,o.w5)((()=>[(0,o._)("button",null,[(0,o._)("div",null,[(0,o.Wm)(C,{icon:a.timeOutline},null,8,["icon"]),(0,o.Uk)(" "+(0,i.zw)(t.fechaPublicacion),1)])])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,o.Wm)(F,{"is-open":a.isOpen,ref_for:!0,ref:"modal","initial-breakpoint":.35,breakpoints:[.25,.5,.75,1]},{default:(0,o.w5)((()=>[(0,o.Wm)(R,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[m])),_:1}),(0,o.Wm)(V,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{color:"light",onClick:e[3]||(e[3]=e=>a.setOpen(!1,null))},{default:(0,o.w5)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(W,null,{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:"itemComentario"},{default:(0,o.w5)((()=>[(0,o.Wm)(M,{position:"floating"},{default:(0,o.w5)((()=>[p])),_:1}),(0,o.Wm)(A,{"clear-input":"",type:"text",modelValue:a.comentarioIntroducido,"onUpdate:modelValue":e[4]||(e[4]=e=>a.comentarioIntroducido=e)},null,8,["modelValue"]),(0,o.Wm)(C,{icon:a.arrowDownCircleOutline,slot:"end",onClick:e[5]||(e[5]=e=>a.anadirComentario())},null,8,["icon"])])),_:1}),(0,o.Wm)(z,{class:"list"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.comentariosMostrados,(e=>((0,o.wg)(),(0,o.j4)(x,{key:e.id,class:"item",onClick:t=>a.opcionesComentario(e.id,e.emailCreador,e.comentario)},{default:(0,o.w5)((()=>[(0,o.Wm)(j,{class:"avatar",slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{src:e.fotoPerfilUsuario},null,8,["src"])])),_:2},1024),(0,o.Wm)(M,null,{default:(0,o.w5)((()=>[(0,o._)("h5",null,(0,i.zw)(e.creador)+": "+(0,i.zw)(e.comentario),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["is-open","initial-breakpoint","breakpoints"])])),_:2},1024)))),128))])),_:1})])),_:1}))])),_:1})}var h=t(2262);const w=(0,o.Uk)("Cancelar"),g=(0,o.Uk)("Modal"),R=(0,o.Uk)("Confirmar");function I(a,e,t,n,r,c){const l=(0,o.up)("ion-button"),s=(0,o.up)("ion-buttons"),d=(0,o.up)("ion-title"),u=(0,o.up)("ion-toolbar"),m=(0,o.up)("ion-header"),f=(0,o.up)("ion-label"),p=(0,o.up)("ion-input"),b=(0,o.up)("ion-item"),h=(0,o.up)("ion-content");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{color:"medium",onClick:a.cancel},{default:(0,o.w5)((()=>[w])),_:1},8,["onClick"])])),_:1}),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[g])),_:1}),(0,o.Wm)(s,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{onClick:a.confirm},{default:(0,o.w5)((()=>[R])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,o.Wm)(h,{class:"ion-padding"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,{position:"stacked"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(a.mensaje),1)])),_:1}),(0,o.Wm)(p,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=e=>a.name=e),placeholder:"Introduce el nuevo mensaje"},null,8,["modelValue"])])),_:1})])),_:1})],64)}var k=t(7330),_=(0,o.aZ)({name:"ModalMensaje",components:{IonContent:k.W2,IonHeader:k.Gu,IonTitle:k.wd,IonToolbar:k.sr,IonButtons:k.Sm,IonButton:k.YG,IonItem:k.Ie,IonLabel:k.Q$,IonInput:k.pK},props:["mensaje"],data(){return{name:""}},methods:{cancel(){return k.Fy.dismiss(null,"cancel")},confirm(){return k.Fy.dismiss(this.name,"confirm")}}}),v=t(3744);const W=(0,v.Z)(_,[["render",I]]);var C=W,U=t(6216),y=t(8903);const x={class:"svg",width:"36",height:"36",fill:"#fff",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},M=(0,o.uE)('<g data-v-796de662><circle cx="12" cy="3" r="1" data-v-796de662><animate id="a" begin="0;l.end-0.5s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="16.50" cy="4.21" r="1" data-v-796de662><animate id="b" begin="a.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="7.50" cy="4.21" r="1" data-v-796de662><animate id="l" begin="k.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="19.79" cy="7.50" r="1" data-v-796de662><animate id="c" begin="b.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="4.21" cy="7.50" r="1" data-v-796de662><animate id="k" begin="j.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="21.00" cy="12.00" r="1" data-v-796de662><animate id="d" begin="c.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="3.00" cy="12.00" r="1" data-v-796de662><animate id="j" begin="i.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="19.79" cy="16.50" r="1" data-v-796de662><animate id="e" begin="d.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="4.21" cy="16.50" r="1" data-v-796de662><animate id="i" begin="h.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="16.50" cy="19.79" r="1" data-v-796de662><animate id="f" begin="e.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="7.50" cy="19.79" r="1" data-v-796de662><animate id="h" begin="g.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><circle cx="12" cy="21" r="1" data-v-796de662><animate id="g" begin="f.begin+0.1s" attributeName="r" calcMode="spline" dur="0.6s" values="1;2;1" keySplines=".27,.42,.37,.99;.53,0,.61,.73" data-v-796de662></animate></circle><animateTransform attributeName="transform" type="rotate" dur="6s" values="360 12 12;0 12 12" repeatCount="indefinite" data-v-796de662></animateTransform></g>',1),D=[M];function S(a,e,t,i,n,r){return(0,o.wg)(),(0,o.iD)("svg",x,D)}var P=(0,o.aZ)({name:"IconoSvg"});const O=(0,v.Z)(P,[["render",S],["__scopeId","data-v-796de662"]]);var V=O,z=t(3181),F=t(1911),j=(t(6162),t(1902));function Z(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const e=16*Math.random()|0,t="x"==a?e:3&e|8;return t.toString(16)}))}var N=(0,o.aZ)({name:"Tab1Page",components:{IonHeader:k.Gu,IonToolbar:k.sr,IonTitle:k.wd,IonContent:k.W2,IonPage:k._i,IonButton:k.YG,IonButtons:k.Sm,IonItem:k.Ie,IonList:k.q_,IonCard:k.PM,IonCardHeader:k.Zi,IonCardContent:k.FN,IonLabel:k.Q$,IonAvatar:k.BJ,IonFooter:k.fr,IonCol:k.wI,IonRow:k.Nd,IonIcon:k.gu,IonText:k.yW,Swiper:z.tq,SwiperSlide:z.o5,IonImg:k.Xz,iconoSVGBlanco:V,IonSearchbar:k.VI,IonGrid:k.jY,IonModal:k.ki,IonInput:k.pK,IconoSVGBlanco:V},data(){return{cargando:!1,isOpen:!1,darkMode:!1,comentarioIntroducido:"",nombreRuta2:"",comentariosMostrados:[],nombreUsuario:U.I.currentUser.displayName,opciones:[],modificandoRuta:!1,nombreRutaModificada:""}},methods:{async openModal(a,e,t){const o=await k.Fy.create({component:C,componentProps:{mensaje:e}});o.present();const{data:i,role:n}=await o.onWillDismiss();"confirm"===n&&await U.db.collection("rutas").get().then((async a=>{a.forEach((async a=>{console.log(a.id),await U.db.collection("rutas").doc(a.id).collection("comentarios").get().then((o=>{o.forEach((async o=>{if(o.id==t)for(var n of(await U.db.collection("rutas").doc(a.id).collection("comentarios").doc(o.id).update({comentario:i}),this.comentariosMostrados))n.comentario==e&&(n.comentario=i)}))}))}))}))},async setOpenModalModificar(){this.modificandoRuta=!this.modificandoRuta},async presentActionSheetBorrar(a,e,t){const o=await k.BO.create({header:"Comentario",buttons:[{text:"Borrar",role:"destructive",id:"delete-button",data:{type:"delete"},handler:()=>{console.log("Borrar comentario clickado")}},{text:"Editar",role:"edit",handler:()=>{console.log("Editar clickado"),this.openModal(t,e,a)}},{text:"Cancelar",handler:()=>{console.log("Cancelar clickado")}}]});await o.present();const{role:i}=await o.onDidDismiss();"destructive"==i?(await U.db.collection("users").doc(U.I.currentUser.uid).collection("mensajes").doc(this.emailUsuario).collection("conversacion").get().then((e=>{e.forEach((async e=>{e.data().id==a&&(this.uidMensajeABorrar=e.id)}))})),await U.db.collection("users").doc(U.I.currentUser.uid).collection("mensajes").doc(this.emailUsuario).collection("conversacion").doc(this.uidMensajeABorrar).delete(),this.$router.go()):"edit"==i&&(this.editarMensaje=!0)},async modificarCampos(a){const e=a.split(":")[0];if("Tipo de ruta"===e){const e=a.split(":")[1];if(console.log(e)," Lineal"===e){const a=await k.BO.create({header:"Selecciona la nueva categoria: ",buttons:[{text:"Circular",handler:async()=>{console.log("Circular clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"rutaCircular"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}},{text:"Ascensión",handler:async()=>{console.log("Ascensión clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"ascension"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({puntuacion:j.Z.firestore.FieldValue.increment(10),rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}}]});await a.present()}else if(" Circular"===e){const a=await k.BO.create({header:"Selecciona la nueva categoria: ",buttons:[{text:"Lineal",handler:async()=>{console.log("Lineal clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"rutaLineal"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({puntuacion:j.Z.firestore.FieldValue.increment(10),rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}},{text:"Ascensión",handler:async()=>{console.log("Ascensión clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"ascension"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({puntuacion:j.Z.firestore.FieldValue.increment(10),rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}}]});await a.present()}else{const a=await k.BO.create({header:"Selecciona la nueva categoria: ",buttons:[{text:"Circular",handler:async()=>{console.log("Circular clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"rutaCircular"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({puntuacion:j.Z.firestore.FieldValue.increment(-10),rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}},{text:"Lineal",handler:async()=>{console.log("Lineal clickado"),this.modificandoRuta=!this.modificandoRuta,await U.db.collection("rutas").doc(this.nombreRutaModificada).update({tipoRuta:"rutaLineal"}),await U.db.collection("users").doc(U.I.currentUser.uid).update({puntuacion:j.Z.firestore.FieldValue.increment(-10),rutasModificadas:j.Z.firestore.FieldValue.increment(1)}),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaModificada).update({estadoRuta:"modificada"}),this.rutas=[],this.obtenerRutasDisponibles()}}]});await a.present()}}},async presentActionSheetDenunciar(a){const e=await k.BO.create({header:"Comentario",buttons:[{text:"Denunciar",role:"destructive",id:"delete-button",data:{type:"delete"},handler:()=>{console.log("Denunciar comentario clickado")}},{text:"Cancelar",handler:()=>{console.log("Cancelar clickado")}}]});await e.present();const{role:t}=await e.onDidDismiss()},setOpen(a,e){this.nombreRuta=e,this.rutas.forEach((a=>{a.nombreRuta===e&&(this.comentariosMostrados=a.comentarios)})),this.isOpen=a,0==a&&(this.comentariosMostrados=[]),console.log(this.nombreRuta),console.log(this.comentariosMostrados)},async denunciarRuta(){const a=await k.Cl.create({header:"Estás seguro de que quieres denunciar esta ruta?",buttons:[{text:"Si",role:"confirmar",handler:()=>{this.handlerMessage="Denuncia confirmada"}},{text:"No",role:"cancelar",handler:()=>{this.handlerMessage="Denuncia cancelada"}}]});await a.present();const{role:e}=await a.onDidDismiss();this.roleMessage=`Confirmado con respuesta: ${e}`},async borrarRuta(a,e){const t=await k.Cl.create({header:"Estás seguro de que quieres borrar esta ruta?",buttons:[{text:"Si",role:"confirmar",handler:()=>{this.handlerMessage="Ruta Borrada"}},{text:"No",role:"cancelar",handler:()=>{this.handlerMessage="Ruta conservada"}}]});await t.present();const{role:o}=await t.onDidDismiss();"confirmar"==o&&(console.log("Ruta borrada"),await U.db.collection("rutas").doc(a).delete(),await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(a).delete(),"Circular"==e||"Lineal"==e?await U.db.collection("users").doc(U.I.currentUser?.uid).update({rutasRealizadas:j.Z.firestore.FieldValue.increment(-1),puntuacion:j.Z.firestore.FieldValue.increment(-5)}):"Ascension"==e&&await U.db.collection("users").doc(U.I.currentUser?.uid).update({rutasRealizadas:j.Z.firestore.FieldValue.increment(1),puntuacion:j.Z.firestore.FieldValue.increment(-15)}),this.obtenerRutasDisponibles())},async modificarRuta(a){this.opciones=[],this.opciones.push("Nombre: "+a.nombreRuta),this.opciones.push("Localización: "+a.localizacion),this.opciones.push("Tipo de ruta: "+a.tipoRuta),this.opciones.push("Valoracion: "+a.valoracion),this.opciones.push("Kilometros: "+a.kilometros),this.nombreRutaModificada=a.nombreRuta,this.modificandoRuta=!this.modificandoRuta},async rutaRealizada(a,e){await U.db.collection("users").doc(U.I.currentUser.uid).collection("rutasUsuario").doc(this.nombreRutaIntroducido).set({estadoRuta:"realizada",imagenesIntroducidas:a}).then(this.$emit("anadir-ruta")),"Circular"==e||"Lineal"==e?await U.db.collection("users").doc(U.I.currentUser?.uid).update({rutasRealizadas:j.Z.firestore.FieldValue.increment(1),puntuacion:j.Z.firestore.FieldValue.increment(3)}):"Ascension"==e&&await U.db.collection("users").doc(U.I.currentUser?.uid).update({rutasRealizadas:j.Z.firestore.FieldValue.increment(1),puntuacion:j.Z.firestore.FieldValue.increment(7)})}},setup(){const a=(0,h.qj)({rutas:[]}),e=(0,k.cj)(),t={initialSlide:0,speed:400},o=async()=>{e.push("/tabs/anadirRutaNueva")},i=async a=>{console.log(a),e.push("/tabs/tabUserRuta/"+a)};async function n(a,e,t){e==U.I.currentUser.email?this.presentActionSheetBorrar(a,t):this.presentActionSheetDenunciar()}async function r(){await U.db.collection("users").doc(U.I.currentUser?.uid).get().then((async a=>{const e=new Date,t=Z(),o={creador:U.I.currentUser.displayName,comentario:this.comentarioIntroducido,fechaPublicacion:`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`,fotoPerfilUsuario:a.data().fotoPerfil,email:a.data().email};this.comentariosMostrados.push(o),await U.db.collection("rutas").doc(this.nombreRuta).collection("comentarios").doc(t).set({creador:U.I.currentUser.displayName,comentario:this.comentarioIntroducido,fechaPublicacion:`${e.getDate()}/${e.getMonth()+1}/${e.getFullYear()}`,fotoPerfilUsuario:a.data().fotoPerfil,email:a.data().email}),console.log("Comentario introducido en la ruta: "+this.nombreRuta),this.comentarioIntroducido=""}))}async function c(){var e,t,o;this.cargando=!0,await U.db.collection("rutas").get().then((i=>{i.forEach((async i=>{var n=[];await U.db.collection("users").get().then((async r=>{r.forEach((a=>{a.data().email==i.data().emailUsuario&&(e=a.data().fotoPerfil,t=a.data().puntuacion)})),t<=10?o="Novat@":t>10&&t<=20?o="Caminante":t>20&&t<=35?o="Intrépid@":t>35&&t<=50?o="Ruter@":t>50&&t<=70?o="Expert@":t>70&&(o="Pro"),"rutaCircular"==i.data().tipoRuta?(await U.db.collection("rutas").doc(i.data().nombreRuta).collection("comentarios").get().then((a=>{a.forEach((a=>{n.push({id:a.id,comentario:a.data().comentario,creador:a.data().creador,fechaPublicacion:a.data().fechaPublicacion,fotoPerfilUsuario:a.data().fotoPerfilUsuario,emailCreador:a.data().email})}))})),a.rutas.push({id:i.id,nombreRuta:i.data().nombreRuta,localizacion:i.data().localizacion,imagenesIntroducidas:i.data().imagenesIntroducidas,usuario:i.data().usuarioIntroducido,nivelUsuario:o,tipoRuta:"Circular",valoracion:i.data().valoracion,kilometros:i.data().kilometros,fotoPerfilUsuarioIntroducida:e,iconoIntroducido:y.fm$,fechaPublicacion:i.data().fechaPublicacion,emailRuta:i.data().emailUsuario,comentarios:n})):"rutaLineal"==i.data().tipoRuta&&(await U.db.collection("rutas").doc(i.data().nombreRuta).collection("comentarios").get().then((a=>{a.forEach((a=>{n.push({id:a.id,comentario:a.data().comentario,creador:a.data().creador,fechaPublicacion:a.data().fechaPublicacion,fotoPerfilUsuario:a.data().fotoPerfilUsuario,emailCreador:a.data().email})}))})),a.rutas.push({id:i.id,nombreRuta:i.data().nombreRuta,localizacion:i.data().localizacion,imagenesIntroducidas:i.data().imagenesIntroducidas,usuario:i.data().usuarioIntroducido,nivelUsuario:o,tipoRuta:"Lineal",valoracion:i.data().valoracion,kilometros:i.data().kilometros,fotoPerfilUsuarioIntroducida:e,iconoIntroducido:y.ElJ,fechaPublicacion:i.data().fechaPublicacion,emailRuta:i.data().emailUsuario,comentarios:n})),"ascension"==i.data().tipoRuta&&(await U.db.collection("rutas").doc(i.data().nombreRuta).collection("comentarios").get().then((a=>{a.forEach((a=>{n.push({id:a.id,creador:a.data().creador,fechaPublicacion:a.data().fechaPublicacion,fotoPerfilUsuario:a.data().fotoPerfilUsuario,comentario:a.data().comentario,emailCreador:a.data().email})}))})),a.rutas.push({id:i.id,nombreRuta:i.data().nombreRuta,localizacion:i.data().localizacion,imagenesIntroducidas:i.data().imagenesIntroducidas,usuario:i.data().usuarioIntroducido,nivelUsuario:o,tipoRuta:"Ascension",valoracion:i.data().valoracion,kilometros:i.data().kilometros,fotoPerfilUsuarioIntroducida:e,iconoIntroducido:y.FMn,fechaPublicacion:i.data().fechaPublicacion,emailRuta:i.data().emailUsuario,comentarios:n})),console.log(i.id," => ",i.data())}))}))})),this.cargando=!1,console.log("Estas son las rutas: "),console.log(a.rutas)}return{opcionesComentario:n,obtenerRutasDisponibles:c,anadirComentario:r,goAddRoute:o,irPerfilUsuario:i,...(0,h.BK)(a),timeOutline:y.bdY,starOutline:y.i6c,resizeOutline:y.ElJ,repeatOutline:y.fm$,flagOutline:y.FMn,analyticsOutline:y.VAV,addCircleOutline:y.hd1,searchOutline:y.W6I,locationOutline:y.Iv7,checkmarkDoneSharp:y.hK6,chatbubbles:y.gju,chevronForwardOutline:y.Dji,arrowDownCircleOutline:y.BC_,alertOutline:y.SaV,closeOutline:y.fID,pencilSharp:y.OHb,slideOpts:t,modules:[F.W_,F.tl]}},watch:{$route(a,e){this.rutas=[],this.obtenerRutasDisponibles(),console.log(U.I.currentUser.displayName)}},mounted(){this.obtenerRutasDisponibles()}});const B=(0,v.Z)(N,[["render",b],["__scopeId","data-v-14a4ec63"]]);var E=B}}]);
//# sourceMappingURL=367.7ff6a7ec.js.map